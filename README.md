# 諸行無常ログ (Shogyo Mujo Log)

※コミットは必ず書いてください！

チーム：観世音菩薩
コンセプト：「暴食」は煩悩。代償は「苦悩」。
キャッチコピー：食べるのは煩悩、ハゲるのは罰。カロリーという業を、歩数という徳で焼き払え。

## 🛠 開発環境・技術スタック (Tech Stack)

このプロジェクトでは、以下のツールと技術を使用します。各自インストールと設定をお願いします。

### 💻 基本ツール (Basic Tools)

**VSCode**: コードエディタ
**Git**: バージョン管理

### 📱 フロントエンド (Frontend)

**Flutter SDK**: クロスプラットフォーム開発フレームワーク
**Dart**: 開発言語 [cite: 166]
**Android Studio**: Androidエミュレータ・ビルド用
**pedometer**: 歩数取得用ライブラリ
**Google Fit / Apple Health**: ヘルスケアデータ連携

### ⚙️ バックエンド (Backend)

**Java (JDK)**: 開発言語
**Spring Boot**: Webフレームワーク
**Firebase**: データベース (Firestore) および認証

### 🤖 AI・API (External Services)

**Gemini API**: 画像解析・判定ロジック用
**OpenAI API**: 画像生成用 (DALL-E等)

---

## 📱 アプリの起動方法 (How to Run the App)

### 🖥️ 開発モードでFlutterアプリを起動する

1. **VSCodeで `frontend` フォルダを開く**
   - `shogyoumujo/frontend` フォルダをVSCodeで開きます

2. **依存パッケージをインストール**

   ```bash
   flutter pub get
   ```

3. **エミュレータまたは実機を接続**
   - Android Studio のエミュレータを起動、または
   - USB デバッグを有効にした実機をUSBケーブルで接続

4. **アプリを起動**
   ```bash
   flutter run
   ```

   - または、VSCode の「実行とデバッグ」から起動
   - F5 キーでも起動可能

### 📦 APK（インストールファイル）をビルドする

Android端末にインストール可能なAPKファイルを作成する手順：

1. **ターミナルで `frontend` フォルダに移動**

   ```bash
   cd shogyoumujo/frontend
   ```

2. **リリース用APKをビルド**

   ```bash
   flutter build apk --release
   ```

3. **完成したAPKファイルの場所**

   ```
   build/app/outputs/flutter-apk/app-release.apk
   ```

4. **Android端末へのインストール方法**
   - APKファイルをAndroid端末に転送（USBケーブル、クラウドストレージ、メールなど）
   - 端末の「ファイルマネージャー」からAPKファイルをタップ
   - 「提供元不明のアプリ」のインストールを許可
   - インストール完了後、アプリを起動

### � app-release.apk のインストールと起動手順（詳細版）

**前提条件：** `flutter build apk --release` でAPKファイルがビルド済みであること

#### 方法1️⃣：USBケーブルでインストール

1. **Android端末のUSBデバッグを有効化**
   - 端末の「設定」→「デバイス情報」→「ビルド番号」を7回タップして開発者モードを有効化
   - 「設定」→「開発者向けオプション」→「USBデバッグ」をONにする

2. **端末をPCに接続**
   - USBケーブルでAndroid端末とPCを接続
   - 端末に「USBデバッグを許可しますか？」と表示されたら「OK」をタップ

3. **adbコマンドでインストール**

   ```bash
   cd shogyoumujo/frontend/build/app/outputs/flutter-apk
   adb install app-release.apk
   ```

   - または、エクスプローラーでAPKファイルをドラッグ＆ドロップして端末に転送

4. **アプリを起動**
   - 端末のアプリ一覧から「諸行無常ログ」アイコンをタップ

#### 方法2️⃣：ファイル転送でインストール

1. **APKファイルを端末に転送**
   - **Google ドライブ/Dropbox**: APKをアップロード → 端末でダウンロード
   - **メール/LINE**: APKを添付して送信 → 端末で開く
   - **USBケーブル**: PCと端末を接続 → APKをDownloadsフォルダにコピー

2. **端末で「提供元不明のアプリ」を許可**
   - Android 8.0以降：
     - APKファイルをタップ → 「この提供元のアプリを許可」をON
   - Android 7.1以前：
     - 「設定」→「セキュリティ」→「提供元不明のアプリ」をON

3. **APKファイルをタップしてインストール**
   - 「ファイルマネージャー」または「ダウンロード」アプリを開く
   - `app-release.apk` をタップ
   - 「インストール」ボタンをタップ
   - インストール完了まで待つ（数秒～数十秒）

4. **アプリを起動**
   - 「開く」ボタンをタップ、または
   - ホーム画面のアプリ一覧から「諸行無常ログ」をタップ

#### 🔐 セキュリティに関する注意

- 初回起動時、カメラ・ストレージ・位置情報などの権限を要求される場合があります
- 必要に応じて「許可」をタップしてください
- アプリが正常に動作しない場合は、権限設定を確認してください

### �🔧 ビルドエラーが発生した場合

```bash
# キャッシュをクリア
flutter clean

# 依存関係を再インストール
flutter pub get

# 再ビルド
flutter build apk --release
```

---

## 🚀 開発の進め方 (Development Workflow)

チーム全員が安全に、かつ効率よく開発するための「鉄の掟」と「手順」です。

### 🛑 【絶対厳守】 鉄の掟 (Iron Rules)

1. **`main` ブランチを直接編集しない！**
   - `main` は常に「動く状態」のアプリです。ここにバグのあるコードを直接入れると、全員の開発が止まります。
   - 必ず「自分用の作業ブランチ」を作ってから作業してください。
2. **作業開始前は必ず `pull` する！**
   - 誰かが更新した最新の状態を取り込まずに作業すると、後で「競合（コンフリクト）」が起きて地獄を見ます。
3. **「デスクトップ」で作業しない！**
   - 必ず `shogyo-mujo-log` フォルダの中（VSCode上）で作業してください。

---

### 🌿 ブランチ運用のルール (Branching Strategy)

作業内容に合わせて、以下の名前でブランチ（並行世界）を作ってください。

| 種類             | ブランチ名のルール | 例                  | 用途                     |
| :--------------- | :----------------- | :------------------ | :----------------------- |
| **新機能**       | `feature/機能名`   | `feature/camera-ui` | 新しい画面や機能を作る時 |
| **修正**         | `fix/バグ内容`     | `fix/login-error`   | バグやミスを直す時       |
| **ドキュメント** | `docs/内容`        | `docs/api-spec`     | 設計書やREADMEを書く時   |

---

### 🔄 毎日の開発サイクル (Daily Routine)

#### 1. 準備 (Start)

1. **VSCodeを開く**。
2. 左下のブランチ名をクリックし、**`main`** に切り替える。
3. 「ソース管理」メニューから **「プル (Pull)」** を行い、最新の状態にする。
4. 左下のブランチ名をクリックし、**「新しい分岐の作成...」** を選ぶ。
5. ルールに従って名前を入力する（例: `feature/login-button`）。

#### 2. 作業 (Coding)

- コードを書く、修正する。
- **こまめに保存**する。

#### 3. 記録 (Commit)

- 作業がひと段落したら、ソース管理タブを開く。
- **「＋」** を押してステージする。
- **コミットメッセージ**を入力してコミットする。
  - 🙆‍♂️ 良い例: `ログインボタンのデザインを修正`
  - 🙅‍♂️ 悪い例: `あ`、`修正`、`update`

#### 4. 送信 (Push)

- 青い **「ブランチの発行」** または **「変更の同期」** 　ボタンを押す。
- これでGitHub上にあなたの作業ブランチがアップロードされます。

---

### 🤝 合体・レビュー (Pull Request)

作業が完了し、`main` に統合（マージ）したい時は、以下の手順で行います。

1. **GitHubのWebサイト**を開く。
2. 画面上部に「`feature/xxx` had recent pushes...」と出るので、緑色の **[Compare & pull request]** ボタンを押す。
3. **タイトル**と**内容**（何をしたか、スクショなど）を書く。
4. 右側の **Reviewers** でチームメンバー（担当AやBなど）を指定する。
5. **[Create pull request]** を押す。
6. レビュアー（確認者）は内容を確認し、問題なければ **[Merge pull request]** を押して合体させる。
   - ⚠️ **合体後は、自分のPCで `git checkout main` → `git pull` をして、最新を取り込むのを忘れずに！**

---

### 🚑 トラブルシューティング

- **「競合 (Conflict)」** が起きたら？
  - VSCode上で「どっちのコードを採用するか」選ぶ画面が出ます。
  - 自分だけで判断せず、チャット等で「ここぶつかったんだけど、どっち残す？」と相談してください。
- **間違って `main` で作業しちゃった！**
  - 慌てず、コミットする前に「新しいブランチ」を作成してください。変更内容ごとお引越しできます。
